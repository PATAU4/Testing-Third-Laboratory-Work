# Testing-Third-Laboratory-Work
третья лабораторная работа, функции работы с API, тесты для функций работы с API

## Содержание работы:

## Функций работы с API:


В данных программах реализованы методы: GET, POST, PUT, DELETE

GET:

1. Получение ключа:


Программа обращается за получением ключа API, посредством передачи данных пользователя, чтобы проверилось их наличие в БД. Если такие данные есть, то пользователь считается проверенным и ему .get посылает ключ. Сам же ключ необходим в каждом действии при работе с API.

Реализовал небольшой парсинг по ключу, импортировал модуль Json, достал значение ключа, затем во всем коде импортировал эту программу с значением ключа ( более интеренсый способ передачи ключа, а не тупое копирование из консоли и вставка в новую программу как отдельную переменную )

Итог работы: ( получили API ключ )

<img width="627" alt="Снимок экрана 2021-12-19 в 14 20 59" src="https://user-images.githubusercontent.com/90206600/146673085-dc068cef-78d0-43b3-9e4d-f76c38969ac0.png">

2. Получение списка питомцев:

<img width="725" alt="Снимок экрана 2021-12-19 в 13 29 20" src="https://user-images.githubusercontent.com/90206600/146671777-6ad4e344-1655-4141-b7e0-371d46c9586a.png">

GET запрос к API за получением информации о питомцах пользовтеля. В списке содержится информация о имени, id, типе животного и фотография на аватарке.

Итог работы: ( получили список питомцев )

<img width="432" alt="Снимок экрана 2021-12-19 в 14 21 41" src="https://user-images.githubusercontent.com/90206600/146673094-b1bbe430-e527-414e-b520-906730f60c1a.png">

POST:

1. Создание "простого питомца":

<img width="867" alt="Снимок экрана 2021-12-19 в 13 32 48" src="https://user-images.githubusercontent.com/90206600/146671863-c9075c83-5fc1-47a5-a383-a5a93d81f733.png">

Программа передает необходимые параметры для добавления нового питомца:

<img width="839" alt="Снимок экрана 2021-12-19 в 13 35 37" src="https://user-images.githubusercontent.com/90206600/146671950-7bebc5b6-e284-41b7-81df-96f5749953c2.png">

Метод POST:

<img width="475" alt="Снимок экрана 2021-12-19 в 13 40 13" src="https://user-images.githubusercontent.com/90206600/146672045-3f47a155-27e9-41b6-b491-a4dab2a115a6.png">

Итог работы: ( создался новый питомец )

<img width="519" alt="Снимок экрана 2021-12-19 в 14 23 14" src="https://user-images.githubusercontent.com/90206600/146673145-ba96d24a-af02-46cc-88df-6b08f1df4417.png">

Отображение на сайте: 

<img width="703" alt="Снимок экрана 2021-12-19 в 14 24 26" src="https://user-images.githubusercontent.com/90206600/146673176-f6ec1fe6-7dee-4a0b-837a-a7c749a7473d.png">


2. Создание питомца с доп. информацией ( передачей изображения питомца ):

<img width="974" alt="Снимок экрана 2021-12-19 в 13 41 17" src="https://user-images.githubusercontent.com/90206600/146672068-1744c874-7619-407a-b435-bf2753c347cf.png">

Аналогичная структура как и с "простым" питомцем, за исключением дополнительного параметра "Files", в него передается изображение в бинарном виде.

<img width="398" alt="Снимок экрана 2021-12-19 в 13 57 26" src="https://user-images.githubusercontent.com/90206600/146672506-a41afcf1-da7d-4aed-8789-99e239243fcc.png">

Итог работы: ( создание питомца с изображение )

<img width="529" alt="Снимок экрана 2021-12-19 в 14 27 48" src="https://user-images.githubusercontent.com/90206600/146673257-5498f324-25b7-480c-83ad-4d6017149080.png">

Отображение на сайте: ( моего питомца зовут арольф )

<img width="569" alt="Снимок экрана 2021-12-19 в 14 34 12" src="https://user-images.githubusercontent.com/90206600/146673404-1e2e5c8b-8fa0-4c00-9b60-a22a6a732fc3.png">


3. Добавление изображения существующему питомцу:

<img width="958" alt="Снимок экрана 2021-12-19 в 13 46 00" src="https://user-images.githubusercontent.com/90206600/146672230-3823de9e-9afe-46ae-8395-05f8dde6607a.png">

По сути это упрощенный код "Создание питомца с доп. информацией", в нем отсутствуют параметры с именем, типом и возрастом животного, поскольку они не нужны. Нужен ID животного для определения нужного нам питомца ( ну и ключ естественно, без него никуда ). 

Были разные идеи как реализовать парсинг по ID, оставил нахождение по имени, поскольку ID это произвольный набор символов и его нереально запоминать, намного легче находить животного по имени и возвращать его ID.

<img width="446" alt="Снимок экрана 2021-12-19 в 13 48 43" src="https://user-images.githubusercontent.com/90206600/146672310-96589875-1814-4a67-b38f-c33bf271cde0.png">

( Arolf в данном случае - имя питомца )

Итог работы: 

<img width="977" alt="Снимок экрана 2021-12-19 в 14 35 40" src="https://user-images.githubusercontent.com/90206600/146673439-60fff3e9-7743-4794-be7e-7e38c9e5864b.png">

Отображение на сайте:  ( изображение овчарки поменялось на выбраное мной, плакующую жабу )

<img width="592" alt="Снимок экрана 2021-12-19 в 14 35 56" src="https://user-images.githubusercontent.com/90206600/146673445-98b9536e-486f-4480-8ee6-e1e3c555f01c.png">


DELETE:

<img width="974" alt="Снимок экрана 2021-12-19 в 13 51 35" src="https://user-images.githubusercontent.com/90206600/146672379-4f4c033c-4abe-4e95-a563-c304c0c2d97b.png">

Метод DELETE, работает как и "Добавление изображения существующему питомцу", парсится ID животного по его имени и удаляется, вместо изменение аватара животного. 

Итог работы: 

<img width="464" alt="Снимок экрана 2021-12-19 в 14 37 13" src="https://user-images.githubusercontent.com/90206600/146673478-af60b987-0c04-4bb1-b64e-60bde58c6e05.png">


Отображение на сайте: ( жаба-арольф пропала )

<img width="849" alt="Снимок экрана 2021-12-19 в 14 37 59" src="https://user-images.githubusercontent.com/90206600/146673497-5f632378-336c-4fb5-ba9f-ad993de67ded.png">

PUT:

<img width="975" alt="Снимок экрана 2021-12-19 в 13 53 55" src="https://user-images.githubusercontent.com/90206600/146672431-e711863c-5386-4b10-93d7-4669c921f458.png">

Метод PUT, реализует изменение данных у существующего питомца. Аналогичная история, по имени животного находится его ID, по ID находится список с информацией о питомце и в него передаются новые данные.

Итог работы: ( я указал новое имя арольфа - это абобус, ему 54 года )

<img width="503" alt="Снимок экрана 2021-12-19 в 14 39 42" src="https://user-images.githubusercontent.com/90206600/146673541-11ce5865-325f-4887-be3f-bc039813264d.png">

Отображение на сайте:

<img width="854" alt="Снимок экрана 2021-12-19 в 14 40 24" src="https://user-images.githubusercontent.com/90206600/146673565-7e0d21b2-c70e-48c0-928b-77fe8e84645e.png">

## Тесты для функций работы с API:
 
Все проверки реалзованны в одной программе:

<img width="205" alt="Снимок экрана 2021-12-19 в 13 21 28" src="https://user-images.githubusercontent.com/90206600/146672568-be610233-7926-42a1-b7ad-fbc71c29e4ac.png">

1. Проверки с помощью Фикстур:

Импортирую все программы с методами ( GET, POST, DELETE, PUT ):

<img width="357" alt="Снимок экрана 2021-12-19 в 14 01 23" src="https://user-images.githubusercontent.com/90206600/146672574-70acdde2-c00f-44de-86be-e45660796c16.png">

Фикстуры отделил в блоки друг от друга с помощью комментов, соответсвующих проверяемым методам ( для проверки get - блок get и т.д. )

<img width="484" alt="Снимок экрана 2021-12-19 в 14 02 19" src="https://user-images.githubusercontent.com/90206600/146672603-f68365ae-523d-4405-8013-0c7654113594.png">

Фикстуры и их тестирование аноличны друг другу:

<img width="314" alt="Снимок экрана 2021-12-19 в 14 04 56" src="https://user-images.githubusercontent.com/90206600/146672668-5f133312-8df8-40d2-9bf0-7ff89fc604ad.png">

В фикстуре содержиться необходимая информация для проверки ( у меня это просто вызываемая программа ), под ней находится её проверка:

<img width="454" alt="Снимок экрана 2021-12-19 в 14 05 59" src="https://user-images.githubusercontent.com/90206600/146672695-297d1331-c7d7-4752-a962-f5959e4be5c9.png">

Проверка считается удачной, если работа фикстуры возвращается True ( следовательно в функции проверки, True сравнивается с 1, если истинно, тогда проверка проходит )

Итог проверки фикстур: 

<img width="1392" alt="Снимок экрана 2021-12-19 в 14 07 33" src="https://user-images.githubusercontent.com/90206600/146672736-9b0e5a2c-1334-46c3-b044-0146b34c719c.png">

Покрытие 100%

2. Проверки с помощью параметризации:

В качестве примера продемострирую тестирование метода GET:

<img width="1037" alt="Снимок экрана 2021-12-19 в 14 08 36" src="https://user-images.githubusercontent.com/90206600/146672764-562c6aed-fad1-4e9c-9117-f2021ca92210.png">

В отдельные переменные передаю значения для будующих параметров в параметризации:

<img width="996" alt="Снимок экрана 2021-12-19 в 14 10 17" src="https://user-images.githubusercontent.com/90206600/146672813-e421b8e7-db2b-4158-a1d2-6ad20a7c3bff.png">

Затем создаю саму параметризацию:

<img width="1074" alt="Снимок экрана 2021-12-19 в 14 11 15" src="https://user-images.githubusercontent.com/90206600/146672833-7a2ffb8c-d2a7-4a22-94ee-7d1a0f7ae16d.png">

Структура слудующая:

Сначала задаются параметры необходимые для проверки:

<img width="264" alt="Снимок экрана 2021-12-19 в 14 11 48" src="https://user-images.githubusercontent.com/90206600/146672848-2c536eef-e9a9-40a8-8451-62b2d7d28644.png">

Затем идут списки ( из количество зависит от количества желаемых проверок и переданных значений )
В моем случае два списка, в них содержится информация, которая будет использоваться для проверки
( т.е. две проверки )

<img width="839" alt="Снимок экрана 2021-12-19 в 14 12 32" src="https://user-images.githubusercontent.com/90206600/146672868-8fd8a637-8bb9-45a1-a10a-df54d249223a.png">

Также я реализовал два сценария проверки:
Негивный и Позитивный. В позитивном я передаю правильную информацию для проверки, а в негативном, специально указываю неверный ключ API, и в ожидаемом результате указываю Fasle, ( т.е. при ошибке, проверка будет считаться пройденной )

<img width="935" alt="Снимок экрана 2021-12-19 в 14 14 00" src="https://user-images.githubusercontent.com/90206600/146672903-e743eff4-db5b-4a6a-9ea2-75d1058cf1f8.png">

Итог проверки параметризации:

<img width="1386" alt="Снимок экрана 2021-12-19 в 14 19 21" src="https://user-images.githubusercontent.com/90206600/146673039-40f66701-f1f0-4d99-a724-41b717c44c5c.png">



Итог общей проверки ( и фикстуры и параметризации )

<img width="1390" alt="Снимок экрана 2021-12-19 в 14 20 35" src="https://user-images.githubusercontent.com/90206600/146673071-376f81b2-4e11-40c8-8e18-82422d72ec00.png">



